language = Objective-C
package = CryptoBridge
---
#import <Foundation/Foundation.h>

NS_ASSUME_NONNULL_BEGIN

@interface CryptoBridge : NSObject

+ (NSArray<NSData *> *)generateX25519KeyPair;
+ (nullable NSData *)x25519DHWithPrivateKey:(NSData *)privateKey
                                  publicKey:(NSData *)publicKey
                                      error:(NSError * _Nullable *)error;

+ (NSData *)hkdfSha256WithIkm:(NSData *)ikm
                          salt:(NSData *)salt
                          info:(NSData *)info
                     outputLen:(NSInteger)outputLen;

+ (nullable NSData *)chachaEncryptWithKey:(NSData *)key
                                    nonce:(NSData *)nonce
                                plaintext:(NSData *)plaintext
                                      aad:(NSData *)aad
                                    error:(NSError * _Nullable *)error;

+ (nullable NSData *)chachaDecryptWithKey:(NSData *)key
                               ciphertext:(NSData *)ciphertext
                                      aad:(NSData *)aad
                                    error:(NSError * _Nullable *)error;

+ (NSArray<NSData *> *)generateEd25519KeyPair;
+ (nullable NSData *)signWithPrivateKey:(NSData *)privateKey
                                message:(NSData *)message
                                  error:(NSError * _Nullable *)error;

+ (BOOL)verifyWithPublicKey:(NSData *)publicKey
                    message:(NSData *)message
                  signature:(NSData *)signature;

+ (NSData *)randomBytes:(NSInteger)size;

@end

NS_ASSUME_NONNULL_END
